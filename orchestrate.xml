<?xml version="1.0" encoding="UTF-8"?>
<exp:Export Version="3.0"
    xmlns:L7p="http://www.layer7tech.com/ws/policy"
    xmlns:exp="http://www.layer7tech.com/ws/policy/export" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
    <exp:References/>
    <wsp:Policy xmlns:L7p="http://www.layer7tech.com/ws/policy" xmlns:wsp="http://schemas.xmlsoap.org/ws/2002/12/policy">
        <wsp:All wsp:Usage="Required">
            <L7p:AuditAssertion/>
            <L7p:HttpRoutingAssertion>
                <L7p:ProtectedServiceUrl stringValue="http://192.168.99.100:8085"/>
                <L7p:ProxyPassword stringValueNull="null"/>
                <L7p:ProxyUsername stringValueNull="null"/>
                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Cookie"/>
                        </L7p:item>
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="SOAPAction"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:RequestHeaderRules>
                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included"/>
                </L7p:RequestParamRules>
                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Set-Cookie"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:ResponseHeaderRules>
                <L7p:ResponseMsgDest stringValue="httpResponse1"/>
                <L7p:SamlAssertionVersion intValue="2"/>
            </L7p:HttpRoutingAssertion>
            <L7p:HttpRoutingAssertion>
                <L7p:ProtectedServiceUrl stringValue="http://192.168.99.100:8086"/>
                <L7p:ProxyPassword stringValueNull="null"/>
                <L7p:ProxyUsername stringValueNull="null"/>
                <L7p:RequestHeaderRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Cookie"/>
                        </L7p:item>
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="SOAPAction"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:RequestHeaderRules>
                <L7p:RequestParamRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included"/>
                </L7p:RequestParamRules>
                <L7p:ResponseHeaderRules httpPassthroughRuleSet="included">
                    <L7p:ForwardAll booleanValue="true"/>
                    <L7p:Rules httpPassthroughRules="included">
                        <L7p:item httpPassthroughRule="included">
                            <L7p:Name stringValue="Set-Cookie"/>
                        </L7p:item>
                    </L7p:Rules>
                </L7p:ResponseHeaderRules>
                <L7p:ResponseMsgDest stringValue="httpResponse2"/>
                <L7p:SamlAssertionVersion intValue="2"/>
            </L7p:HttpRoutingAssertion>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PHJlc3BvbnNlMSB4bWxucz0idXJuOnJlc3BvbnNlMSI+DQoke2h0dHBSZXNwb25zZTEubWFpbnBhcnR9DQo8L3Jlc3BvbnNlMT4="/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="modifiedResponse1"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PHJlc3BvbnNlMiB4bWxucz0idXJuOnJlc3BvbnNlMiI+DQoke2h0dHBSZXNwb25zZTIubWFpbnBhcnR9DQo8L3Jlc3BvbnNlMj4="/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="modifiedResponse2"/>
            </L7p:SetVariable>
            <L7p:SetVariable>
                <L7p:Base64Expression stringValue="PGM6Y29tYmluZWQgeG1sbnM6Yz0idXJuOmNvbWJpbmVkIj4NCiR7bW9kaWZpZWRSZXNwb25zZTEubWFpbnBhcnR9DQoke21vZGlmaWVkUmVzcG9uc2UyLm1haW5wYXJ0fQ0KPC9jOmNvbWJpbmVkPg=="/>
                <L7p:ContentType stringValue="text/xml; charset=utf-8"/>
                <L7p:DataType variableDataType="message"/>
                <L7p:VariableToSet stringValue="combinedXML"/>
            </L7p:SetVariable>
            <L7p:XslTransformation>
                <L7p:Direction intValue="-1"/>
                <L7p:OtherTargetMessageVariable stringValue="combinedXML"/>
                <L7p:ResourceInfo staticResourceInfo="included">
                    <L7p:Document stringValueReference="inline"><![CDATA[<xsl:stylesheet version="2.0" xmlns:c="urn:combined" xmlns:r1="urn:response1" xmlns:r2="urn:response2" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
	<xsl:template match="/">
		<c:root>
			<xsl:for-each select="c:combined/r1:response1/r1:root/r1:Customer">
				<c:Customer>
				
				
					 <xsl:variable name="email" select="r1:email/text()"/>
					 
					<c:email><xsl:value-of select="r1:email"/></c:email>
					<c:zip><xsl:value-of select="r1:zip"/></c:zip>
					   
					
					<xsl:for-each select="//r2:Customer[r2:email=$email]">
					<c:bought><xsl:value-of select="r2:boughtBook"/></c:bought>
					</xsl:for-each>
				</c:Customer>
			</xsl:for-each>
		</c:root>			
	</xsl:template>
</xsl:stylesheet>]]></L7p:Document>
                </L7p:ResourceInfo>
                <L7p:Target target="OTHER"/>
                <L7p:TransformName stringValue=""/>
                <L7p:XsltVersion stringValue="1.0"/>
            </L7p:XslTransformation>
            <L7p:HardcodedResponse>
                <L7p:Base64ResponseBody stringValue="JHtjb21iaW5lZFhNTC5tYWlucGFydH0="/>
            </L7p:HardcodedResponse>
        </wsp:All>
    </wsp:Policy>
</exp:Export>
